## Exploiting Numerical Calculation Errors
Exploiting Numerical Calculation Errors (56.03%).
|Serial number| Reporting time | Bug link  | Root cause | Exploitation method | Fix strategy  |
|    :---:    |      :---:     |    :---:    |      :---:     |      :---:     |      :---:     |
|1|2021-09-16|[2021-06-pooltogether#h-04](https://code4rena.com/reports/2021-06-pooltogether#h-04-withdraw-timelock-can-be-circumvented)| The time lock mechanism did not take effect as expected, allowing users to bypass the time lock and withdraw funds directly. | The withdrawWithTimelockFrom() function sets incorrect _unlockTimestamps. | The withdrawWithTimelockFrom() function should increment the unlock timestamp by the specified duration.
|2|2021-08-17|[2021-07-wildcredit#h-02](https://code4rena.com/reports/2021-07-wildcredit#h-02-lendingpairliquidateaccount-does-not-accrue-and-update-cumulativeinterestrate)| The accumulated interest rate is not updated during account liquidation.| Interest calculation error, the borrower bypassed interest payment through self liquidation. | Revise the previous accumulated interest rate update method.
|3|2021-09-15|[2021-07-pooltogether#h-03](https://code4rena.com/reports/2021-07-pooltogether#h-03-setyieldsource-leads-to-temporary-wrong-results)|Token balances are not promptly updated when the contract switches revenue sources. | The calculation of balance and shares is incorrect, resulting in users receiving undeserved shares. | Remove calls to the external functions transferFunds and setYieldSource, and restrict swapYieldSource to owner-only access.
|4|2021-09-17|[2021-08-yield#h-02](https://code4rena.com/reports/2021-08-yield#h-02-erc20rewards-returns-wrong-rewards-if-no-tokens-initially-exist)| The _updateRewardsPerToken function early returns when totalSupply is zero. | When minting for the first time, the user mistakenly received all the rewards from the previous reward period. | Update lastUpdated even when totalSupply is zero.
|5|2022-01-26|[2021-09-defiprotocol#h-02](https://code4rena.com/reports/2021-09-defiprotocol#h-02-basketsolauctionburn-a-failed-auction-will-freeze-part-of-the-funds)|The auctionBurn function does not update ibRatio when burning auction bonds. | The calculation of total supply was incorrect, resulting in some assets being frozen. | Update ibRatio based on the withdrawn amount in the auctionBurn function.
|6|2022-02-09|[2021-12-mellow#h-04](https://code4rena.com/reports/2021-12-mellow#h-04-aavevault-does-not-update-tvl-on-depositwithdraw)|The total value locked (TVL) is not promptly updated when users deposit or withdraw. | Wrong token share calculated using outdated TVL. | First update the TVL, then proceed with other operations when depositing or withdrawing tokens.
|7|2022-02-11|[2021-11-streaming#h-08](https://code4rena.com/reports/2021-11-streaming#h-08-tstokens-sometimes-calculated-incorrectly)| ts.tokens == 0 causes ts.lastUpdate to remain unupdated. | Ts.token was miscalculated, resulting in the extraction of more tokens than it should have been. | Update ts.lastUpdate even when ts.tokens is zero.
|8|2022-05-02|[2021-12-defiprotocol#h-01](https://code4rena.com/reports/2021-12-defiprotocol#h-01-wrong-fee-calculation-after-totalsupply-was-0)| lastFee is not updated in the handleFees function when totalSupply is zero. | When the basket is replenished, the cost will be calculated based on the incorrect time difference. | Update lastFee even when totalSupply is zero.
|9|2023-03-07|[2021-12-amun#h-01](https://code4rena.com/reports/2021-12-amun#h-01-unused-erc20-tokens-are-not-refunded-and-can-be-stolen-by-attacker)|The remaining tokens are not refunded. | Incorrect calculation and refund of remaining underlying tokens. | Calculate and trade only the required token amount, then refund any remaining tokens to the user after the transaction.
|10|2022-05-24|[2022-02-concur#h-01](https://code4rena.com/reports/2022-02-concur#h-01-wrong-reward-token-calculation-in-masterchef-contract)|The reward distribution for old pools is not updated when adding new token pools. | Users are unable to accurately calculate the rewards they deserve. | Call massUpdate() to refresh rewards for all existing pools before adding a new one.
|11|2022-06-02|[2022-04-backd#h-02](https://code4rena.com/reports/2022-04-backd#h-02-function-lockfunds-in-topupactionlibrary-can-cause-serious-fund-lose-fee-and-capped-bypass-its-not-calling-stakervaultincreaseactionlockedbalance-when-transfers-stakes)| The actionLockedBalances[payer] is not updated for the payer when transferring stakes.| stakedAndActionLockedBalanceOf() calculates wrong balance | Call stakerVault.increaseActionLockedBalance to update after transferring funds.
|12|2023-02-17|[2022-12-tigris#h-01](https://code4rena.com/reports/2022-12-tigris#h-01-locksol-assets-deposited-with-lockextendlock-function-are-lost)|The Lock.extendLock function increases the locked amount but does not update the total locked amount. | An accounting error resulted in the inability to release locked assets added through the extendLock() function in the future. | Update totalLocked[_asset] in Lock.extendLock.
|13|2022-11-29|[2022-09-frax#h-01](https://code4rena.com/reports/2022-09-frax#h-01-wrong-accounting-logic-when-syncrewards-is-called-within-beforewithdraw-makes-withdrawals-impossible)| The syncRewards() function is not called to synchronize rewards before executing withdrawal operations. | An accounting logic error caused the nextRewards calculation to be inflated, resulting in overpayment of rewards. | Call syncRewards() before calling beforeWithdraw().
|14|2022-12-22|[2022-10-traderjoe#h-05](https://code4rena.com/reports/2022-10-traderjoe#h-05-attacker-can-steal-entire-reserves-by-abusing-fee-calculation)| Exception handling for the zero address (address(0)) and the contract's own address (address(this)) skips _cacheFees updates for these addresses. | Exploiting faulty accounting logic to bypass proper fee accumulation when collectFees() is called and steal reserve assets. | Modify the skip conditions and add overflow checks.
|15|2023-01-09|[2022-10-juicebox#h-01](https://code4rena.com/reports/2022-10-juicebox#h-01-making-a-payment-to-the-protocol-with-_dontmint-parameter-will-result-in-lost-fund-for-user)| When _dontMint is true, the function immediately returns without incrementing the user's creditsOf balance. | The user's payment amount was not correctly added to the credit balance, resulting in lost funds. | Add an update to creditsOf[_data.beneficiary] before the return statement.
|16|2023-01-13|[2022-08-frax#h-01](https://code4rena.com/reports/2022-08-frax#h-01-any-borrower-with-bad-debt-can-be-liquidated-multiple-times-to-lock-funds-in-the-lending-pair)|The liquidateClean function does not update the borrower's loan shares. | The borrower's remaining share is not deducted from its actual debt. | Include the remaining shares in _sharesToLiquidate after liquidation.
|17|2023-01-20|[2022-11-stakehouse#h-10](https://code4rena.com/reports/2022-11-stakehouse#h-10-giantmevandfeespoolbringunusedethbackintogiantpool-function-loses-the-addition-of-the-idleeth-which-allows-attackers-to-steal-most-of-eth-from-the-giant-pool)| The idleETH is not incremented when returning ETH. | The idleETH is not increased correctly, allowing the attacker to call the bringUnusedETHBackIntoGiantPool() function to steal ETH. | Increment the idleETH value accordingly in the bringUnusedETHBackIntoGiantPool() function.
|18|2023-01-20|[2022-11-stakehouse#h-08](https://code4rena.com/reports/2022-11-stakehouse#h-08-function-withdraweth-from-giantmevandfeespool-can-steal-most-of-eth-because-of-idleeth-is-reduced-before-burning-token)| The idleETH is decremented before LP token burning. | The reward calculation is wrong, and the attacker calls the withdrawETH() function to steal ETH. | Decrement idleETH only after token burning.
|19|2023-01-20|[2022-11-stakehouse#h-06](https://code4rena.com/reports/2022-11-stakehouse#h-06-bringunusedethbackintogiantpool-can-cause-stuck-ether-funds-in-giant-pool)|The variable idleETH is not synchronized. | An error in the calculation of idleETH caused ETH withdrawn from the vault to be permanently locked in the Giant Pool. | Add an update for idleETH.
|20|2023-01-31|[2022-12-backed#h-01](https://code4rena.com/reports/2022-12-backed#h-01-borrowers-may-earn-auction-proceeds-without-filling-the-debt-shortfall)| The variable for accumulating and storing the remaining debt after each auction is lacking. | The debt was not properly liquidated, resulting in the auction proceeds going directly to the borrower. | Increase the record of the debt gap through the newly added _shortfall variable.
|21|2023-02-07|[2022-11-debtdao#h-05](https://code4rena.com/reports/2022-11-debtdao#h-05-borrower-can-craft-a-borrow-that-cannot-be-liquidated-even-by-arbiter-)|The ids[] array is not reordered to place new loans at the ids[0] position. | Errors in recording new loans enabled borrowers to create loans that could not be liquidated. | Reorder the ids array to update the new loan entry to ids[0].
|22|2023-02-28|[2023-01-ondo#h-01](https://code4rena.com/reports/2023-01-ondo#h-01-loss-of-user-funds-when-completing-cash-redemptions)|The variable totalBurned is not updated. | The amount received by the user during subsequent redemption is inaccurate, resulting in financial loss. | After refunding refundedAmt, update totalBurned to deduct the refunded amount.
|23|2023-03-10|[2023-01-timeswap#h-03](https://code4rena.com/reports/2023-01-timeswap#h-03-the-collect-function-will-always-transfer-zero-fees-losing-_feespositions-without-receiving-fees)| The calculation of variables like long0Fees and long1Fees is executed only after the transferFees() function call. | The incorrect calculation of the long0Fees, long1Fees and other variables used to calculate fees caused the transfer fee to always be zero. | Calculate the actual values of long0Fees, long1Fees, and shortFees before calling transferFees().
|24|2023-03-21|[2022-12-gogopool#h-01](https://code4rena.com/reports/2022-12-gogopool#h-01-avax-assigned-high-water-is-updated-incorrectly)| The maximum AVAX allocation per node in the cycle is increased via the increaseAVAXAssignedHighWater() function, rather than being directly updated to the current AVAXAssigned value. | The attacker manipulates AVAX higher than the actual allocation to obtain more rewards. | Change the previous cumulative update method to directly update to the current AVAXAssigned value.
|25|2023-04-05|[2022-07-golom#h-10](https://code4rena.com/reports/2022-07-golom#h-10-upon-changing-of-delegate-votedelegation-updates-both-the-previous-and-the-current-checkpoint)|When updating the voting proxy, both the old and new checkpoints were updated, causing the previous checkpoint to erroneously include the latest changes. | Incorrect vote counting affects the integrity of the voting system. | Modify the "storage checkpoint" to "memory checkpoint" in both the delegate() and removeDelegation() functions.
|26|2023-04-05|[2022-07-golom#h-07](https://code4rena.com/reports/2022-07-golom#h-07-_writecheckpoint-does-not-write-to-storage-on-same-block)| During delegate operations, the "Checkpoint memory oldCheckpoint" in the function is only modified in memory and not written to storage. | The checkpoint is not written correctly, and the user's second delegation operation will not be persisted, resulting in the loss of delegation information. | Change "memory oldCheckpoint" to "storage oldCheckpoint".
|27|2023-04-11|[2023-03-neotokyo#h-01](https://code4rena.com/reports/2023-03-neotokyo#h-01-updating-a-pools-total-points-doesnt-affect-existing-stake-positions-for-rewards-calculation)| There is a lack of variables for tracking the reward distribution of each point. | The reward calculation did not correctly reflect the changes in the total points of the pool, affecting the user's rewards. | Introduce the rewardPerTokenStored variable to track the reward distribution for each point.
|28|2023-04-27|[2023-03-mute#h-01](https://code4rena.com/reports/2023-03-mute#h-01-bond-max-buyer-might-end-up-buying-the-max-buy-of-the-next-epoch)| A variable for tracking the current period number is missing. | max_buy was miscalculated, causing users to incorrectly buy the next period's worth of bonds at a lower price than expected. | Add a variable "currentEpoch" to track the current cycle number.
|29|2023-04-27|[2022-11-paraspace#h-01](https://code4rena.com/reports/2022-11-paraspace#h-01-data-corruption-in-nftfloororacle-denial-of-service)|The index in feederPositionMap is not updated when removing oracle addresses. | A calculation error caused an out-of-bounds access error when deleting the feeder. | Synchronize updates to oracle indexes moved to new positions in feederPositionMap during deletion.
|30|2023-05-01|[2023-02-malt#h-06](https://code4rena.com/reports/2023-02-malt#h-06-stabilizernodestabilize-uses-stale-globalimpliedcollateralservice-data-which-will-make-stabilize-incorrect)| Call syncGlobalCollateral() at the end of stabilize(). | Using an outdated collateralRatio for stabilization calculations can make stabilization operations inaccurate and may cause tokens to depeg. | Call impliedCollateralService() before stabilize() executes.
|31|2023-05-01|[2023-02-malt#h-05](https://code4rena.com/reports/2023-02-malt#h-05-_distributeprofit-will-use-the-stale-globalicswingtradercollateraldeficitswingtradercollateralratio-which-will-result-in-incorrect-profit-distribution)| The profit distribution ratio is calculated before updating the dependent values. | Using inaccurate values ​​when allocating profits leads to incorrect profit distribution, causing LPs (liquidity providers) to receive too much profit. | Call syncGlobalCollateral() before calling handleProfit().
|32|2023-05-01|[2023-02-malt#h-02](https://code4rena.com/reports/2023-02-malt#h-02-rewardthrottle-if-an-epoch-does-not-have-any-profit-then-there-may-not-be-rewards-for-that-epoch-at-the-start-of-the-next-epoch)| The location of the _fillInEpochGaps() call is incorrect. | fillInEpochGaps() did not correctly calculate and request rewards from overflowPool, resulting in lost rewards for unprofitable epochs. | Remove the call to fillInEpochGaps(). Or, move the call to checkRewardUnderflow() to the beginning of each new epoch. Or, restrict calls to fillInEpochGaps() to administrators only.
|33|2023-05-01|[2023-02-malt#h-01](https://code4rena.com/reports/2023-02-malt#h-01-rewardthrottlecheckrewardunderflow-might-track-the-cumulative-aprs-wrongly)| The _sendToDistributor() function early returns if amount == 0. | The cumulative APR was not calculated correctly, affecting the target APR calculation in updateDesiredAPR(). | Add conditions and modify the logic in _sendToDistributor() to update the current epoch's cumulative APR with the previous epoch's APR value when the amount is zero.
|34|2023-05-22|[2023-01-astaria#h-16](https://code4rena.com/reports/2023-01-astaria#h-16-when-public-vault-a-buys-out-public-vault-bs-lien-tokens-it-does-not-increase-public-vault-as-liensopenforepoch-which-would-result-in-the-lien-tokens-not-being-repaid)|liensOpenForEpoch is not incremented when purchasing liens. | When Public Vault A acquired lien tokens, liensOpenForEpoch was not calculated correctly, resulting in an overflow when repaying. | Add a call to increaseEpochLienCount().
|35|2023-05-22|[2023-01-astaria#h-06](https://code4rena.com/reports/2023-01-astaria#h-06-buying-out-corrupts-the-slope-of-a-vault-reducing-rewards-of-lps)| The variable for interest calculation remains unupdated during buyout operations. | The slope of the new lien tokens is not added to the total slope of the public vault, borrowers are not paid interest, and liquidity providers cannot receive rewards. | Add the new lien slope back to the total slope after buyout completion.
|36|2023-06-23|[2023-05-party#h-01](https://code4rena.com/reports/2023-05-party#h-01-the-distribution-logic-will-be-broken-after-calling-ragequit)| Calculate the allocation ratio for each faction's NFTs based on the current totalVotingPower. | The users’ allocation shares were miscalculated, allowing the attacker to obtain more funds than they deserved by destroying NFTs. | Do not use dynamic totalVotingPower for allocation. Instead, record the initial totalVotingPower at the time of each distribution.
|37|2023-06-23|[2023-04-party#h-07](https://code4rena.com/reports/2023-04-party#h-07-initialethcrowdfund--reraiseethcrowdfund-batchcontributefor-function-may-not-refund-eth-which-leads-to-loss-of-funds)| Decrement the ethAvailable before each contributeFor() call. | When a contribution fails, the remaining ETH is not correctly calculated and refunded to the user, resulting in the user losing funds. | Move the ethAvailable decrement operation after the contributeFor() call.
|38|2023-08-01|[2023-03-polynomial#h-07](https://code4rena.com/reports/2023-03-polynomial#h-07-missing-totalfunds-update-in-liquiditypools-openshort-causing-liquiditypool-token-holder-to-lose-a-portion-of-their-token-value)|The deducted transaction fees (feesCollected - externalFee) are not added to totalFunds after calculating net transaction fees. | The totalFunds calculation error affects the available funds in the liquidity pool, causing liquidity providers to lose part of their funds. | Add the net collected transaction fees to totalFunds in the openShort() function.
|39|2023-08-01|[2023-03-polynomial#h-05](https://code4rena.com/reports/2023-03-polynomial#h-05-uneven-deduction-of-performance-fee-causes-some-kangaroovault-users-to-lose-part-of-their-token-value)| The performance fee is not deducted during liquidation. | The fees deducted when closing a position were not distributed correctly, causing users to lose part of the token value when withdrawing. | Deduct performanceFee from premiumCollected in getTokenPrice().
|40|2023-08-01|[2023-03-polynomial#h-04](https://code4rena.com/reports/2023-03-polynomial#h-04-kangaroovaultremovecollateral-updates-storage-without-actually-removing-collateral-resulting-in-lost-collateral)| Collateral data is marked as removed on-chain but not actually withdrawn. | The amount of collateral is reduced in storage but not deducted from the transaction, resulting in the loss of collateral. | Call removeCollateral() to withdraw collateral while updating usedFunds.
|41|2023-08-01|[2023-03-polynomial#h-01](https://code4rena.com/reports/2023-03-polynomial#h-01-exchange_liquidate-function-can-cause-liquidator-to-burn-too-much-powerperp-tokens)|The update to totalCollateralReturned is missing. | Liquidators burn excessive powerPerp tokens, resulting in a loss of funds. | Calculate the token amount corresponding to the collateral actually received by the liquidator, then match the burned token quantity with the liquidator's actual received collateral value.
|42|2023-08-07|[2023-05-particle#h-02](https://code4rena.com/reports/2023-05-particle#h-02-treasury-fee-is-not-collected-in-withdrawethwithinterest)|The treasury fee is not deducted from the interest paid to lenders. | The treasury fees receivable were not deducted from the interest due to the lenders, resulting in the loss of these fees. | Accrue the earned interest to the interestAccrued mapping.
|43|2023-08-21|[2023-06-lybra#h-02](https://code4rena.com/reports/2023-06-lybra#h-02-doesnt-calculate-the-current-borrowing-amount-for-the-provider-including-the-providers-borrowed-shares-and-accumulated-fees-due-to-inconsistency-in-collateralratio-calculation)| The liquidation() and rigidRedemption() functions calculate collateralRatio differently. | Bypass the correct mortgage rate calculation by calculating only the principal amount borrowed and ignoring the share of the borrowing and accumulated fees. | Modify the collateralRatio calculation method in the rigidRedemption() function.
|44|2023-09-07|[2023-01-popcorn#h-11](https://code4rena.com/reports/2023-01-popcorn#h-11-protocol-loses-fees-because-highwatermark-is-updated-every-time-someone-deposit-withdraw-mint)| The highWaterMark is updated whenever a user deposits, withdraws, or mints. | The inability to properly track the progress of earnings makes it impossible for the agreement to correctly charge for earnings when they are available. | Adjust the highWaterMark update timing to occur only during initial deposits and after successful fee collections.
|45|2023-10-11|[2023-08-verwa#h-03](https://code4rena.com/reports/2023-08-verwa#h-03-when-adding-a-gauge-its-initial-value-has-to-be-set-by-an-admin-or-all-voting-power-towards-it-will-be-lost)| The add_gauge() function does not initialize the time_weight value when adding a new gauge. | Initial weights that are not set correctly can result in incorrect calculation of voting rights associated with gauges. | Call change_gauge_weight() when adding a gauge, setting its initial weight to 0.
|46|2023-11-16|[2023-07-tapioca#h-20](https://code4rena.com/reports/2023-07-tapioca#h-20-_liquidateuser-should-not-re-use-the-same-minimum-swap-amount-out-for-multiple-liquidation)| When liquidate() performs clearing operations for multiple users, it uses the same minAssetAmount value and lacks variables for different records. | The liquidation amount was inaccurate, resulting in losses to both the liquidator and the agreement. | Modify the liquidate() function to enable liquidators to pass multiple minAssetAmount parameter values, so that each value corresponds to a different borrower.
|47|2023-12-29|[2023-08-dopex#h-08](https://code4rena.com/reports/2023-08-dopex#h-08-the-peg-stability-module-can-be-compromised-by-forcing-lowerdepeg-to-revert)| totalWethDelegated is not reduced when users withdraw WETH. | Reducing WETH reserves incorrectly resulted in a rollback due to insufficient reserves when attempting to restore the price. | Update totalWethDelegated in the withdraw function.
|48|2023-12-29|[2023-08-dopex#h-05](https://code4rena.com/reports/2023-08-dopex#h-05-users-can-get-immediate-profit-when-deposit-and-redeem-in-perpetualatlanticvaultlp)| Call previewDeposit() before updateFunding(). | The value of the assets calculated at the time of redemption included additional funds for an undeserved profit. | Move the updateFunding() call to before previewDeposit().
|49|2024-01-16|[2023-12-initcapital#h-01](https://code4rena.com/reports/2023-12-initcapital#h-01-liquidations-can-be-prevented-by-frontrunning-and-liquidating-1-debt-or-more-due-to-wrong-assumption-in-pos_manager)|The user's latest debt status is not updated. | Debt shares are miscalculated, which in turn causes subsequent liquidation operations to fail. | Update the user's latest debt record in the _repay() function.
|50|2024-01-26|[2023-12-particle#h-02](https://code4rena.com/reports/2023-12-particle#h-02-openposition-use-stale-feegrowthinside0lastx128feegrowthinside1lastx128)|The fee accumulator value is not synchronized with the pool's current state. | Inaccurate values of fee increases were used to calculate fees over the period of borrowing, which resulted in borrowers paying additional fees at the time of repayment. | Call collectLiquidity() to synchronize the fee accumulator.
|51|2024-02-22|[2023-12-ethereumcreditguild#h-01](https://code4rena.com/reports/2023-12-ethereumcreditguild#h-01-the-usergaugeprofitindex-is-not-set-correctly-allowing-an-attacker-to-receive-rewards-without-waiting)|The user's userGaugeProfitIndex is not properly initialized during the first call to claimGaugeRewards(). | Subsequent bias in the calculation of rewards allows the attacker to be rewarded directly. | Check if userGaugeProfitIndex is 0, and if so, set it to the current gaugeProfitIndex.
|52|2024-04-19|[2024-03-gitcoin#h-01](https://code4rena.com/reports/2024-03-gitcoin#h-01-usertotalstaked-invariant-will-be-broken-due-to-vulnerable-implementations-in-release)|userTotalStaked is not updated when releasing funds. | The actual pledge amount does not match userTotalStaked, thus miscalculating the withdrawn funds at the time of withdrawal. | Update the userTotalStaked in release().
|53|2024-04-19|[2024-01-salty#h-02](https://code4rena.com/reports/2024-01-salty#h-02-first-liquidity-provider-can-claim-all-initial-pool-rewards)|The virtualRewards is not initialized when liquidity is first provided to the protocol. | Ability to incorrectly claim all rewards in the pool due to lack of virtual reward deductions. | Call performUpkeep() before the initial distribution of the contract to achieve initialization.
|54|2024-05-14|[2024-02-ai-arena#h-07](https://code4rena.com/reports/2024-02-ai-arena#h-07-fighters-cannot-be-minted-after-the-initial-generation-due-to-uninitialized-numelements-mapping)| In the constructor, only the 0th Generation (Generation 0) is initialized as 3, while subsequent generations (Generation 1, Generation 2, etc.) are not initialized. | The mapping is uninitialized, resulting in a rollback of the calculation with a divide-by-zero error. | Logic should be added to the contract to allow administrators to correctly initialize or update the numElements map each time a new generation is created.
|55|2024-06-25|[2024-03-dittoeth#h-07](https://code4rena.com/reports/2024-03-dittoeth#h-07-valid-redemption-proposals-can-be-disputed-by-decreasing-collateral)|updatedAt is not updated when creating proposals. | The collateral ratio was calculated incorrectly and was lower than that recorded in other valid redemption proposals, thus successfully initiating an invalid dispute and obtaining penalty fees. | Update updatedAt in the decreaseCollateral() function.
|56|2024-08-06|[2024-05-olas#h-01](https://code4rena.com/reports/2024-05-olas#h-01-pointssumslope-not-updated-after-nominee-removal-and-votes-revocation)|pointsSum.slope is not updated when nominees are removed. | Errors occurred in the calculation of voting weights, affecting the accuracy of the governance mechanism. | Update pointsSum.slope in removeNominee()
|57|2024-07-19|[2024-01-curves#h-02](https://code4rena.com/reports/2024-01-curves#h-02-unrestricted-claiming-of-fees-due-to-missing-balance-updates-in-feesplitter)|Update accumulated rewards only during trades, not transfers. | The fee offset for the new account was not updated, resulting in incorrect calculation of the fees due to the account. | Call onBalanceChange() to update accumulated rewards in all balance-changing operations.
|58|2024-07-25|[2024-04-gondi#h-07](https://code4rena.com/reports/2024-04-gondi#h-07-deploywithdrawalqueue-need-to-clear-_queueaccountinglastqueueindex)|The data in _queueAccounting[lastQueueIndex] is not cleared when deploying a new withdrawal queue. | queueClaimAll() used outdated data and incorrectly allocated the total amount due. | Clear _queueAccounting[lastQueueIndex] data in deployWithdrawalQueue().
|59|2024-07-25|[2024-04-gondi#h-06](https://code4rena.com/reports/2024-04-gondi#h-06-function-settlewithbuyout-does-not-call-loanmanagerloanliquidation-during-a-buyout)|The loan pool accounting records are not updated when lenders buy out loans via the settleWithBuyout() function. | The accounting in the pool was not handled correctly, which affected the balance and profit distribution in the pool. | Call loanLiquidation() within settleWithBuyout() to ensure accounting data updates.
|60|2024-12-08|[2024-jul-gemnify-proleague#h-2](https://github.com/code-423n4/zenith-portfolio/tree/main/reports)|ps.tokenBalances[] is not updated in the safeTransfer() function. | The actual amount received returned to users when withdrawing or transferring funds is incorrect. | Call transferOut() in claimFundingFees() to update token balances during fund transfers.
|61|2024-12-08|[2024-jul-gemnify-proleague#h-5](https://github.com/code-423n4/zenith-portfolio)|When reducing positions, the amount affecting the pool is incorrectly increased.  | The withdrawal amounts were not properly accounted for, falsely increasing the amounts affecting the pool. | Check whether the user's withdrawn funds are sufficient before updating the affected pool.
|62|2024-08-06|[2024-05-olas#h-01](https://code4rena.com/reports/2024-05-olas#h-01-pointssumslope-not-updated-after-nominee-removal-and-votes-revocation)|pointsSum.slope is not updated when nominees are removed. | The slope for the removed nominees is still included in the calculation, resulting in an inaccurate calculation of the voting weight. | Update pointsSum.slope in removeNominee()
|63|2024-08-16|[2024-07-munchables#h-01](https://code4rena.com/reports/2024-07-munchables#h-01-single-plot-can-be-occupied-by-multiple-renters)| toiletState[tokenId].plotId is not updated when users transfer tokens to another plot.| Allowing multiple tenants to occupy the same plot and causing errors in reward calculations. | Update toiletState[tokenId].plotId in the transferToUnoccupiedPlot() function.
|64|2024-08-16|[2024-07-munchables#h-05](https://code4rena.com/reports/2024-07-munchables#h-05-failure-to-update-dirty-flag-in-transfertounoccupiedplot-prevents-reward-accumulation-on-valid-plot)|When the token is transferred from an invalid plot to a valid one, the user's "dirty" flag is not reinitialized. | Reward calculation was skipped by mistake. | Set the "dirty" flag when the user successfully transfers to a valid plot.
|65|2024-09-13|[2024-07-traitforge#h-04](https://code4rena.com/reports/2024-07-traitforge#h-04-number-of-entities-in-generation-can-surpass-the-10k-number)| During generation switching, the current generation's counter genMintCount is reset, failing to accurately record the true minting quantity of the previous generation when the next generation begins. | The number of new generations of entities was calculated incorrectly and allowed infinite generations of entities to be created. | Remove the operation that resets genMintCount.
