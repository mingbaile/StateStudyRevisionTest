## Interim State Exploits
Interim State Exploits (12.93%).
|Serial number| Reporting time |  Bug link  | Root cause | Exploitation method | Fix strategy  |
|    :---:    |      :---:     |    :---:    |      :---:     |      :---:     |      :---:     |
|1|2022-01-21|[2021-11-bootfinance#h-03](https://code4rena.com/reports/2021-11-bootfinance#h-03-swaputilssol-wrong-implementation)| The tokenPrecisionMultipliers used in price calculations is not computed in real-time.| The attacker use old tokenPrecision Multipliers for transactions before the target price takes effect. | Change tokenPrecisionMultipliers to real-time calculation.
|2|2022-05-03|[2021-12-vader#h-10](https://code4rena.com/reports/2021-12-vader#h-10-previousprices-is-never-updated-upon-syncing-token-price)|The syncVaderPrice function does not update previousPrices after synchronizing prices. | The attacker uses the lagged previousPrices to calculate the liquidity assessment and manipulate the liquidity share. | Update the previousPrices array after price synchronization.
|3|2022-07-18|[2022-04-abranft#h-03](https://code4rena.com/reports/2022-04-abranft#h-03-critical-oracle-manipulation-risk-by-lender)| Lenders can replace the Oracle after loan approval. | After the loan is issued, the attacker uses the updateLoanParams() function to maliciously replace the oracle. | Add validation for params.oracle == cur.oracle in the checks.
|4|2022-10-26|[2022-08-olympus#h-03](https://code4rena.com/reports/2022-08-olympus#h-03-trsry-front-runnable-setapprovalfor)|The current allowance is not decremented based on existing withdrawal records. | The attacker can front-run the approval change process to withdraw the previously approved funds early. | Decrement the current allowance based on existing withdrawal records when setting a new allowance.
|5|2022-11-17|[2022-09-party#h-05](https://code4rena.com/reports/2022-09-party#h-05-arbitrarycallsproposalsol-and-listonopenseaproposalsol-safeguards-can-be-bypassed-by-cancelling-in-progress-proposal-allowing-the-majority-to-steal-nft)|The NFT approval is not revoked. | The attacker cancels the proposal in progress, thereby bypassing the protection measures and stealing the NFT. | Clear the authorization after the proposal is canceled.
|6|2023-05-01|[2023-02-malt#h-03](https://code4rena.com/reports/2023-02-malt#h-03-manipulation-of-liveprice-to-receive-defaultincentive-in-2-consecutive-blocks)| Claim rewards when the TWAP falls below the protocol's price threshold. | The attacker received two defaultIncentive rewards through flash loans in two consecutive blocks. | Adjust the reward distribution conditions by adding a cooldown period.
|7|2023-08-07|[2023-05-particle#h-06](https://code4rena.com/reports/2023-05-particle#h-06-marketplace-may-call-onerc721received-and-create-a-lien-during-buynftfrommarket-creating-divergence)| There is a lack of a flag for indicating that the purchase operation of the contract is underway. | onERC721Received() creates two pledge rights in the intermediate state, resulting in the same NFT being bound to two different pledge rights. | Set a _marketBuyFlow flag to indicate that the contract is conducting a market purchase operation.
|8|2023-10-05|[2023-07-basin#h-01](https://code4rena.com/reports/2023-07-basin#h-01-pumps-are-not-updated-in-the-shift-and-sync-functions-allowing-oracle-manipulation)|The oracle Pumps is not updated promptly. | Manipulate the reserves of the current block and thus tamper with the prophecy machine data. | Update the Pumps data immediately after each reserve change.
|9|2023-11-29|[2023-07-axelar#h-01](https://code4rena.com/reports/2023-07-axelar#h-01-expressreceivetoken-can-be-abused-using-reentry)| expressReceiveTokenWithData() delays state updates until after token transfers. | Stealing funds in cross-chain transfers using reentry attacks. | Call _setExpressReceiveTokenWithData() in advance.
|10|2024-05-03|[2024-03-abracadabra-money#h-01](https://code4rena.com/reports/2024-03-abracadabra-money#h-01-anyone-making-use-of-the-magiclps-twap-to-determine-token-prices-will-be-exploitable)| Reserves updates precede TWAP updates. | Manipulate reserve values prior to TWAP updates, manipulate prices and profit on subsequent trades. | Advance the execution position of the _twapUpdate() function.
|11|2024-05-22|[2024-03-revert-lend#h-02](https://code4rena.com/reports/2024-03-revert-lend#h-02-risk-of-reentrancy-onerc721received-function-to-manipulate-collateral-token-configs-shares)|The cleanupLoan() function is called before _updateAndCheckCollateral(). | A reentry attack is utilized to update debt shares multiple times, manipulate borrowing caps, and prevent other users from borrowing. | Call cleanupLoan() after _updateAndCheckCollateral().
|12|2024-06-12|[2024-05-loop#h-01](https://code4rena.com/reports/2024-05-loop#h-01-availability-of-deposit-invariant-can-be-bypassed)|The state variable totalLpETH is not locked to equal totalSupply. | Pre- and post-operations (sandwich attack) to donate ETH and directly obtain lpETH. | Limit the claimedAmount calculation to only the ETH amount obtained from LRT swaps.
|13|2024-06-24|[2024-05-bakerfi#h-04](https://code4rena.com/reports/2024-05-bakerfi#h-04-multiple-swap-lack-slippage-protection)|  The "amountOutMinimum" parameter is missing for slippage protection. | The attacker can manipulate the transaction price through a front-running attack, causing the output amount of the swap to be lower than expected. | Pass the correct amountOutMinimum value.
|14|2024-07-25|[2024-04-gondi#h-17](https://code4rena.com/reports/2024-04-gondi#h-17-refinancefulladdnewtranche-reusing-a-lenders-signature-leads-to-unintended-behavior)| A type field is missing in the signature to distinguish different operation types. | The attacker used the signature of refinanceFull() to prepend addNewTranche(), causing the loan amount to be approximately twice the original amount. | Add a type field in the RenegotiationOffer to distinguish different operation types.
|15|2024-07-28|[2024-06-playfi-proleague#h-2](https://github.com/code-423n4/zenith-portfolio)|  Send the referral commission before updating state variables (totalClaimed, totalLicenses). | The attacker used a reentrancy attack to purchase quantities exceeding the permitted limit. | Process referral commission transfers after updating state variables (totalClaimed, totalLicenses).
