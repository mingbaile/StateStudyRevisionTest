## Change Conditions
Change Conditions (10.34%).
|Serial number| Reporting time |  Bug link  | Root cause | Exploitation method | Fix strategy  |
|    :---:    |      :---:     |    :---:    |      :---:     |      :---:     |      :---:     |
|1|2021-09-15|[2021-07-pooltogether#h-03](https://code4rena.com/reports/2021-07-pooltogether#h-03-setyieldsource-leads-to-temporary-wrong-results)|Token balances are not promptly updated when the contract switches revenue sources. | The calculation of balance and shares is incorrect, resulting in users receiving undeserved shares. | Remove calls to the external functions transferFunds and setYieldSource, and restrict swapYieldSource to owner-only access.
|2|2022-07-18|[2022-04-abranft#h-03](https://code4rena.com/reports/2022-04-abranft#h-03-critical-oracle-manipulation-risk-by-lender)| Lenders can replace the Oracle after loan approval. | After the loan is issued, the attacker uses the updateLoanParams() function to maliciously replace the oracle. | Add validation for params.oracle == cur.oracle in the checks.
|3|2022-12-13|[2022-07-ens#h-02](https://code4rena.com/reports/2022-07-ens#h-02-the-expiry-of-the-parent-node-can-be-smaller-than-the-one-of-a-child-node-violating-the-guarantee-policy)|Child node states are not considered when unwrapping the parent node. | When unblocking child nodes, the original expiration time management mechanism was disrupted. | Add proper constraints when setting child node expiration times and destroy the parent node's CANNOT_UNWRAP permission.
|4|2022-12-22|[2022-10-traderjoe#h-05](https://code4rena.com/reports/2022-10-traderjoe#h-05-attacker-can-steal-entire-reserves-by-abusing-fee-calculation)| Exception handling for the zero address (address(0)) and the contract's own address (address(this)) skips _cacheFees updates for these addresses. | Exploiting faulty accounting logic to bypass proper fee accumulation when collectFees() is called and steal reserve assets. | Modify the skip conditions and add overflow checks.
|5|2023-04-18|[2022-12-tessera#h-03](https://code4rena.com/reports/2022-12-tessera#h-03-groupbuy_verifyunsuccessfulstate-and-_verifysuccessfulstate-both-can-return-true-when-blocktimestamp--poolterminationperiod)|Both _verifyUnsuccessfulState() and _verifySuccessfulState() functions return true for the terminationPeriod timestamp.  | The attacker stole funds by repeatedly claiming already refunded funds. | Change the time comparison condition in the _verifySuccessfulState() function from "<" to "<=".
|6|2023-05-01|[2023-02-malt#h-03](https://code4rena.com/reports/2023-02-malt#h-03-manipulation-of-liveprice-to-receive-defaultincentive-in-2-consecutive-blocks)| Claim rewards when the TWAP falls below the protocol's price threshold. | The attacker received two defaultIncentive rewards through flash loans in two consecutive blocks. | Adjust the reward distribution conditions by adding a cooldown period.
|7|2023-05-01|[2023-02-malt#h-02](https://code4rena.com/reports/2023-02-malt#h-02-rewardthrottle-if-an-epoch-does-not-have-any-profit-then-there-may-not-be-rewards-for-that-epoch-at-the-start-of-the-next-epoch)| The location of the _fillInEpochGaps() call is incorrect. | fillInEpochGaps() did not correctly calculate and request rewards from overflowPool, resulting in lost rewards for unprofitable epochs. | Remove the call to fillInEpochGaps(). Or, move the call to checkRewardUnderflow() to the beginning of each new epoch. Or, restrict calls to fillInEpochGaps() to administrators only.
|8|2023-05-01|[2023-02-malt#h-01](https://code4rena.com/reports/2023-02-malt#h-01-rewardthrottlecheckrewardunderflow-might-track-the-cumulative-aprs-wrongly)| The _sendToDistributor() function early returns if amount == 0. | The cumulative APR was not calculated correctly, affecting the target APR calculation in updateDesiredAPR(). | Add conditions and modify the logic in _sendToDistributor() to update the current epoch's cumulative APR with the previous epoch's APR value when the amount is zero.
|9|2024-02-22|[2023-12-ethereumcreditguild#h-01](https://code4rena.com/reports/2023-12-ethereumcreditguild#h-01-the-usergaugeprofitindex-is-not-set-correctly-allowing-an-attacker-to-receive-rewards-without-waiting)|The user's userGaugeProfitIndex is not properly initialized during the first call to claimGaugeRewards(). | Subsequent bias in the calculation of rewards allows the attacker to be rewarded directly. | Check if userGaugeProfitIndex is 0, and if so, set it to the current gaugeProfitIndex.
|10|2024-12-08|[2024-jul-gemnify-proleague#h-5](https://github.com/code-423n4/zenith-portfolio)|When reducing positions, the amount affecting the pool is incorrectly increased.  | The withdrawal amounts were not properly accounted for, falsely increasing the amounts affecting the pool. | Check whether the user's withdrawn funds are sufficient before updating the affected pool.
|11|2024-08-16|[2024-07-optimism#h-03](https://code4rena.com/reports/2024-07-optimism#h-03-lpp-metadata-can-be-altered-after-the-challenge-period-is-over-allowing-incorrect-states-to-be-proven)| In the initLPP function, the LPPMetadata data structure is not initialized. | Repeatedly calling the initLPP() function modifies the claimedSize and partOffset of LPP, resulting in incorrect state hashing. | Remove unnecessary storage reads in the initLPP function. Additionally, add a check in the squeezeLPP function to ensure that bytesProcessed must be equal to claimedSize.
|12|2024-10-07|[2024-08-phi#h-04](https://code4rena.com/reports/2024-08-phi#h-04-forced-endtime-extension-in-updateartsettings-allows-attacker-to-mint-more-tokens)|The endTime is incorrectly updated to block.timestamp in updateArtSettings().  | The attacker exploited the extended endTime to repeat the transaction and mint additional tokens. | Separate the update logic for "uri", "soulBounded", and "royalty" config. Additionally, change the ">" to ">=" in the time validation condition.
