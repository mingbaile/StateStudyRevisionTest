## Direct Variable Change
Direct Variable Change (Directly Modify Computations on the Unsafe State Variables, 58.62%).
|Serial number| Reporting time |  Bug link  | Root cause | Exploitation method | Fix strategy  |
|    :---:    |      :---:     |    :---:    |      :---:     |      :---:     |      :---:     |
|1|2021-08-30|[2021-05-visorfinance#h-02](https://code4rena.com/reports/2021-05-visorfinance#h-02-nft-transfer-approvals-are-not-removed-and-cannot-be-revoked-thus-leading-to-loss-of-nft-tokens)|The granted NFT transaction authorization is not revoked.|The authorization has not been revoked, and the authorized person can transfer NFTs repeatedly. | Modify the status variables that control the granting or revocation of permissions.
|2|2021-08-30|[2021-05-visorfinance#h-03](https://code4rena.com/reports/2021-05-visorfinance#h-03-approval-for-nft-transfers-is-not-removed-after-transfer) | Failure to clear the approval authorization for NFT resulted in authorized agents being able to transfer the NFT multiple times. | The NFT authorization is not reset.| Reset the approval on transfer.
|3|2021-09-16|[2021-06-pooltogether#h-04](https://code4rena.com/reports/2021-06-pooltogether#h-04-withdraw-timelock-can-be-circumvented)| The time lock mechanism did not take effect as expected, allowing users to bypass the time lock and withdraw funds directly. | The withdrawWithTimelockFrom() function sets incorrect _unlockTimestamps. | The withdrawWithTimelockFrom() function should increment the unlock timestamp by the specified duration.
|4|2021-09-15|[2021-07-pooltogether#h-03](https://code4rena.com/reports/2021-07-pooltogether#h-03-setyieldsource-leads-to-temporary-wrong-results)|Token balances are not promptly updated when the contract switches revenue sources. | The calculation of balance and shares is incorrect, resulting in users receiving undeserved shares. | Remove calls to the external functions transferFunds and setYieldSource, and restrict swapYieldSource to owner-only access.
|5|2021-09-17|[2021-08-yield#h-02](https://code4rena.com/reports/2021-08-yield#h-02-erc20rewards-returns-wrong-rewards-if-no-tokens-initially-exist)| The _updateRewardsPerToken function early returns when totalSupply is zero. | When minting for the first time, the user mistakenly received all the rewards from the previous reward period. | Update lastUpdated even when totalSupply is zero.
|6|2021-11-30|[2021-09-sushitrident-2#h-03](https://code4rena.com/reports/2021-09-sushitrident-2#h-03-concentratedliquiditypoolmanagers-incentives-can-be-stolen)|The reclaimIncentive function does not decrement the incentive.rewardsUnclaimed field. | The attacker repeatedly called the recaaimIncentive function to steal all tokens in the incentive pool. | Decrement the incentive.rewardsUnclaimed field by the withdrawn amount.
|7|2022-01-26|[2021-09-defiprotocol#h-02](https://code4rena.com/reports/2021-09-defiprotocol#h-02-basketsolauctionburn-a-failed-auction-will-freeze-part-of-the-funds)|The auctionBurn function does not update ibRatio when burning auction bonds. | The calculation of total supply was incorrect, resulting in some assets being frozen. | Update ibRatio based on the withdrawn amount in the auctionBurn function.
|8|2021-11-23|[2021-10-mochi#h-06](https://code4rena.com/reports/2021-10-mochi#h-06-referrer-can-drain-referralfeepoolv0)|The claimRewardAsMochi function does not reduce the user's reward balance. | The referrer can repeatedly claim the same reward until the fee pool is exhausted. | Decrement the user's reward balance in the claimRewardAsMochi function.
|9|2021-11-23|[2021-10-mochi#h-11](https://code4rena.com/reports/2021-10-mochi#h-11-treasuryshare-is-overwritten-in-feepoolv0_sharemochi)| The _shareMochi() function incorrectly resets treasuryShare. | VeCRV holders can receive tokens that should have been allocated to treasure multiple times. | Remove the operation that resets treasuryShare.
|10|2022-04-20|[2021-11-unlock#h-03](https://code4rena.com/reports/2021-11-unlock#h-03-mixintransfersoltransferfrom-wrong-implementation-can-potentially-allows-attackers-to-reverse-transfer-and-cause-fund-loss-to-the-users)|The key manager is not reset. | The attacker repeats the transaction after the key transfer, either returning the key to themselves or transferring it to other recipients. | Reset the key manager in the transferFrom function.
|11|2022-04-20|[2021-11-unlock#h-04](https://code4rena.com/reports/2021-11-unlock#h-04-approvals-not-cleared-after-key-transfer)|The _setKeyManagerOf function does not clear single-token approvals. | The attacker repeatedly transfers the key back to themselves from the victim without clearing the previous approval after the key transfer. | Call the _clearApproval function to clear the approval.
|12|2022-02-11|[2021-11-streaming#h-08](https://code4rena.com/reports/2021-11-streaming#h-08-tstokens-sometimes-calculated-incorrectly)| ts.tokens == 0 causes ts.lastUpdate to remain unupdated. | Ts.token was miscalculated, resulting in the extraction of more tokens than it should have been. | Update ts.lastUpdate even when ts.tokens is zero.
|13|2022-05-02|[2021-12-defiprotocol#h-01](https://code4rena.com/reports/2021-12-defiprotocol#h-01-wrong-fee-calculation-after-totalsupply-was-0)| lastFee is not updated in the handleFees function when totalSupply is zero. | When the basket is replenished, the cost will be calculated based on the incorrect time difference. | Update lastFee even when totalSupply is zero.
|14|2022-05-03|[2021-12-vader#h-10](https://code4rena.com/reports/2021-12-vader#h-10-previousprices-is-never-updated-upon-syncing-token-price)|The syncVaderPrice function does not update previousPrices after synchronizing prices. | The attacker uses the lagged previousPrices to calculate the liquidity assessment and manipulate the liquidity share. | Update the previousPrices array after price synchronization.
|15|2022-03-24|[2022-01-behodler#h-04](https://code4rena.com/reports/2022-01-behodler#h-04-logic-error-in-burnflashgovernanceasset-can-cause-locked-assets-to-be-stolen)| Reset the user's pendingFlashDecision to default configuration when processing pending governance decisions. | The attacker repeatedly calls withdrawGovernanceAsset to steal funds. | Properly clear the user's pendingFlashDecision state in the burnFlashGovernanceAsset() function.
|16|2022-05-24|[2022-02-concur#h-01](https://code4rena.com/reports/2022-02-concur#h-01-wrong-reward-token-calculation-in-masterchef-contract)|The reward distribution for old pools is not updated when adding new token pools. | Users are unable to accurately calculate the rewards they deserve. | Call massUpdate() to refresh rewards for all existing pools before adding a new one.
|17|2022-06-02|[2022-04-backd#h-02](https://code4rena.com/reports/2022-04-backd#h-02-function-lockfunds-in-topupactionlibrary-can-cause-serious-fund-lose-fee-and-capped-bypass-its-not-calling-stakervaultincreaseactionlockedbalance-when-transfers-stakes)| The actionLockedBalances[payer] is not updated for the payer when transferring stakes.| stakedAndActionLockedBalanceOf() calculates wrong balance | Call stakerVault.increaseActionLockedBalance to update after transferring funds.
|18|2022-12-13|[2022-07-ens#h-02](https://code4rena.com/reports/2022-07-ens#h-02-the-expiry-of-the-parent-node-can-be-smaller-than-the-one-of-a-child-node-violating-the-guarantee-policy)|Child node states are not considered when unwrapping the parent node. | When unblocking child nodes, the original expiration time management mechanism was disrupted. | Add proper constraints when setting child node expiration times and destroy the parent node's CANNOT_UNWRAP permission.
|19|2023-02-17|[2022-12-tigris#h-01](https://code4rena.com/reports/2022-12-tigris#h-01-locksol-assets-deposited-with-lockextendlock-function-are-lost)|The Lock.extendLock function increases the locked amount but does not update the total locked amount. | An accounting error resulted in the inability to release locked assets added through the extendLock() function in the future. | Update totalLocked[_asset] in Lock.extendLock.
|20|2022-11-17|[2022-09-party#h-05](https://code4rena.com/reports/2022-09-party#h-05-arbitrarycallsproposalsol-and-listonopenseaproposalsol-safeguards-can-be-bypassed-by-cancelling-in-progress-proposal-allowing-the-majority-to-steal-nft)|The NFT approval is not revoked. | The attacker cancels the proposal in progress, thereby bypassing the protection measures and stealing the NFT. | Clear the authorization after the proposal is canceled.
|21|2023-01-09|[2022-10-juicebox#h-01](https://code4rena.com/reports/2022-10-juicebox#h-01-making-a-payment-to-the-protocol-with-_dontmint-parameter-will-result-in-lost-fund-for-user)| When _dontMint is true, the function immediately returns without incrementing the user's creditsOf balance. | The user's payment amount was not correctly added to the credit balance, resulting in lost funds. | Add an update to creditsOf[_data.beneficiary] before the return statement.
|22|2023-01-13|[2022-08-frax#h-01](https://code4rena.com/reports/2022-08-frax#h-01-any-borrower-with-bad-debt-can-be-liquidated-multiple-times-to-lock-funds-in-the-lending-pair)|The liquidateClean function does not update the borrower's loan shares. | The borrower's remaining share is not deducted from its actual debt. | Include the remaining shares in _sharesToLiquidate after liquidation.
|23|2023-01-18|[2022-02-anchor#h-01](https://code4rena.com/reports/2022-02-anchor#h-01-spend-limit-on-owner-can-be-bypassed)|The spend_limit is not decremented based on spent amounts. | config.spend_limit was not reduced after each spend, causing all subsequent spends to bypass the limit and the attacker could call the spend function multiple times. | After the spending operation is successful, reduce the value of config.spend_limit accordingly.
|24|2023-01-20|[2022-11-stakehouse#h-10](https://code4rena.com/reports/2022-11-stakehouse#h-10-giantmevandfeespoolbringunusedethbackintogiantpool-function-loses-the-addition-of-the-idleeth-which-allows-attackers-to-steal-most-of-eth-from-the-giant-pool)| The idleETH is not incremented when returning ETH. | The idleETH is not increased correctly, allowing the attacker to call the bringUnusedETHBackIntoGiantPool() function to steal ETH. | Increment the idleETH value accordingly in the bringUnusedETHBackIntoGiantPool() function.
|25|2023-01-20|[2022-11-stakehouse#h-06](https://code4rena.com/reports/2022-11-stakehouse#h-06-bringunusedethbackintogiantpool-can-cause-stuck-ether-funds-in-giant-pool)|The variable idleETH is not synchronized. | An error in the calculation of idleETH caused ETH withdrawn from the vault to be permanently locked in the Giant Pool. | Add an update for idleETH.
|26|2023-02-07|[2022-11-debtdao#h-05](https://code4rena.com/reports/2022-11-debtdao#h-05-borrower-can-craft-a-borrow-that-cannot-be-liquidated-even-by-arbiter-)|The ids[] array is not reordered to place new loans at the ids[0] position. | Errors in recording new loans enabled borrowers to create loans that could not be liquidated. | Reorder the ids array to update the new loan entry to ids[0].
|27|2023-02-28|[2023-01-ondo#h-01](https://code4rena.com/reports/2023-01-ondo#h-01-loss-of-user-funds-when-completing-cash-redemptions)|The variable totalBurned is not updated. | The amount received by the user during subsequent redemption is inaccurate, resulting in financial loss. | After refunding refundedAmt, update totalBurned to deduct the refunded amount.
|28|2023-02-28|[2022-12-forgeries#h-01](https://code4rena.com/reports/2022-12-forgeries#h-01-admin-does-not-have-to-wait-to-call-lastresorttimelockownerclaimnft)| The recoverTimelock is not updated with each lottery draw. | Administrators can bypass the waiting time limit by repeatedly calling lastResortTimelockOwnerClaimNFT() without waiting for the specified time lock period to expire. | Update recoverTimelock with every lottery draw.
|29|2023-04-05|[2022-07-golom#h-10](https://code4rena.com/reports/2022-07-golom#h-10-upon-changing-of-delegate-votedelegation-updates-both-the-previous-and-the-current-checkpoint)|When updating the voting proxy, both the old and new checkpoints were updated, causing the previous checkpoint to erroneously include the latest changes. | Incorrect vote counting affects the integrity of the voting system. | Modify the "storage checkpoint" to "memory checkpoint" in both the delegate() and removeDelegation() functions.
|30|2023-04-05|[2022-07-golom#h-07](https://code4rena.com/reports/2022-07-golom#h-07-_writecheckpoint-does-not-write-to-storage-on-same-block)| During delegate operations, the "Checkpoint memory oldCheckpoint" in the function is only modified in memory and not written to storage. | The checkpoint is not written correctly, and the user's second delegation operation will not be persisted, resulting in the loss of delegation information. | Change "memory oldCheckpoint" to "storage oldCheckpoint".
|31|2023-04-05|[2022-07-golom#h-04](https://code4rena.com/reports/2022-07-golom#h-04-old-delegatee-not-deleted-when-delegating-to-new-tokenid)|The old delegatee is not removed. | The old delegators were not deleted, resulting in the same user being able to double-count voting rights by delegating the same token multiple times. | remove the user's old delegation before executing a new operation.
|32|2023-04-27|[2022-11-paraspace#h-01](https://code4rena.com/reports/2022-11-paraspace#h-01-data-corruption-in-nftfloororacle-denial-of-service)|The index in feederPositionMap is not updated when removing oracle addresses. | A calculation error caused an out-of-bounds access error when deleting the feeder. | Synchronize updates to oracle indexes moved to new positions in feederPositionMap during deletion.
|33|2023-05-01|[2023-02-malt#h-02](https://code4rena.com/reports/2023-02-malt#h-02-rewardthrottle-if-an-epoch-does-not-have-any-profit-then-there-may-not-be-rewards-for-that-epoch-at-the-start-of-the-next-epoch)| The location of the _fillInEpochGaps() call is incorrect. | fillInEpochGaps() did not correctly calculate and request rewards from overflowPool, resulting in lost rewards for unprofitable epochs. | Remove the call to fillInEpochGaps(). Or, move the call to checkRewardUnderflow() to the beginning of each new epoch. Or, restrict calls to fillInEpochGaps() to administrators only.
|34|2023-05-22|[2023-01-astaria#h-17](https://code4rena.com/reports/2023-01-astaria#h-17-function-processepoch-in-publicvault-would-revert-when-most-of-the-users-withdraw-their-funds-because-of-the-underflow-for-new-yintercept-calculation)|The latest interest is not counted into the total assets. | The next cycle cannot be started correctly and users' funds cannot be withdrawn. | Call accrue() at the beginning of processEpoch() to account for the latest interest.
|35|2023-05-22|[2023-01-astaria#h-16](https://code4rena.com/reports/2023-01-astaria#h-16-when-public-vault-a-buys-out-public-vault-bs-lien-tokens-it-does-not-increase-public-vault-as-liensopenforepoch-which-would-result-in-the-lien-tokens-not-being-repaid)|liensOpenForEpoch is not incremented when purchasing liens. | When Public Vault A acquired lien tokens, liensOpenForEpoch was not calculated correctly, resulting in an overflow when repaying. | Add a call to increaseEpochLienCount().
|36|2023-05-22|[2023-01-astaria#h-06](https://code4rena.com/reports/2023-01-astaria#h-06-buying-out-corrupts-the-slope-of-a-vault-reducing-rewards-of-lps)| The variable for interest calculation remains unupdated during buyout operations. | The slope of the new lien tokens is not added to the total slope of the public vault, borrowers are not paid interest, and liquidity providers cannot receive rewards. | Add the new lien slope back to the total slope after buyout completion.
|37|2023-06-29|[2023-05-ajna#h-02](https://code4rena.com/reports/2023-05-ajna#h-02-positionmanagers-moveliquidity-can-set-wrong-deposit-time-and-permanently-freeze-lp-funds-moved)| The depositTime of the target position is set directly to the depositTime of the source position. | If the bankruptcy time of the target bucket is greater than the deposit time of the source location, the liquidity provider's funds will be permanently frozen. | Update the depositTime of the target position to the latest valid deposit time of that position.
|38|2023-08-01|[2023-03-polynomial#h-07](https://code4rena.com/reports/2023-03-polynomial#h-07-missing-totalfunds-update-in-liquiditypools-openshort-causing-liquiditypool-token-holder-to-lose-a-portion-of-their-token-value)|The deducted transaction fees (feesCollected - externalFee) are not added to totalFunds after calculating net transaction fees. | The totalFunds calculation error affects the available funds in the liquidity pool, causing liquidity providers to lose part of their funds. | Add the net collected transaction fees to totalFunds in the openShort() function.
|39|2023-08-01|[2023-03-polynomial#h-05](https://code4rena.com/reports/2023-03-polynomial#h-05-uneven-deduction-of-performance-fee-causes-some-kangaroovault-users-to-lose-part-of-their-token-value)| The performance fee is not deducted during liquidation. | The fees deducted when closing a position were not distributed correctly, causing users to lose part of the token value when withdrawing. | Deduct performanceFee from premiumCollected in getTokenPrice().
|40|2023-08-01|[2023-03-polynomial#h-04](https://code4rena.com/reports/2023-03-polynomial#h-04-kangaroovaultremovecollateral-updates-storage-without-actually-removing-collateral-resulting-in-lost-collateral)| Collateral data is marked as removed on-chain but not actually withdrawn. | The amount of collateral is reduced in storage but not deducted from the transaction, resulting in the loss of collateral. | Call removeCollateral() to withdraw collateral while updating usedFunds.
|41|2023-08-07|[2023-05-particle#h-02](https://code4rena.com/reports/2023-05-particle#h-02-treasury-fee-is-not-collected-in-withdrawethwithinterest)|The treasury fee is not deducted from the interest paid to lenders. | The treasury fees receivable were not deducted from the interest due to the lenders, resulting in the loss of these fees. | Accrue the earned interest to the interestAccrued mapping.
|42|2023-09-18|[2023-05-maia#h-28](https://code4rena.com/reports/2023-05-maia#h-28-removing-a-bribeflywheel-from-a-gauge-does-not-remove-the-reward-asset-from-the-rewards-depo-making-it-impossible-to-add-a-new-flywheel-with-the-same-reward-token)|The reward records for this Flywheel are not removed simultaneously when removing the BribeFlywheel. | It is not possible to add new Flywheel incentives that would affect the protocol functionality. | Remove the reward token assets associated with the Flywheel.
|43|2023-10-05|[2023-07-basin#h-01](https://code4rena.com/reports/2023-07-basin#h-01-pumps-are-not-updated-in-the-shift-and-sync-functions-allowing-oracle-manipulation)|The oracle Pumps is not updated promptly. | Manipulate the reserves of the current block and thus tamper with the prophecy machine data. | Update the Pumps data immediately after each reserve change.
|44|2023-10-11|[2023-08-verwa#h-03](https://code4rena.com/reports/2023-08-verwa#h-03-when-adding-a-gauge-its-initial-value-has-to-be-set-by-an-admin-or-all-voting-power-towards-it-will-be-lost)| The add_gauge() function does not initialize the time_weight value when adding a new gauge. | Initial weights that are not set correctly can result in incorrect calculation of voting rights associated with gauges. | Call change_gauge_weight() when adding a gauge, setting its initial weight to 0.
|45|2023-11-29|[2023-09-venus#h-01](https://code4rena.com/reports/2023-09-venus#h-01-primesol---user-can-claim-prime-token-without-having-any-staked-xvs-because-his-stakedat-isnt-reset-whenever-he-is-issued-an-irrevocable-token)|The stakedAt timestamp is not reinitialized when a user obtains non-revocable Prime tokens. | Users repeatedly claim Prime token without pledging XVS. | Reinitialize the stakedAt timestamp when issuing non-revocable Prime tokens.
|46|2023-12-29|[2023-08-dopex#h-08](https://code4rena.com/reports/2023-08-dopex#h-08-the-peg-stability-module-can-be-compromised-by-forcing-lowerdepeg-to-revert)| totalWethDelegated is not reduced when users withdraw WETH. | Reducing WETH reserves incorrectly resulted in a rollback due to insufficient reserves when attempting to restore the price. | Update totalWethDelegated in the withdraw function.
|47|2024-01-16|[2023-12-initcapital#h-01](https://code4rena.com/reports/2023-12-initcapital#h-01-liquidations-can-be-prevented-by-frontrunning-and-liquidating-1-debt-or-more-due-to-wrong-assumption-in-pos_manager)|The user's latest debt status is not updated. | Debt shares are miscalculated, which in turn causes subsequent liquidation operations to fail. | Update the user's latest debt record in the _repay() function.
|48|2024-01-26|[2023-12-particle#h-02](https://code4rena.com/reports/2023-12-particle#h-02-openposition-use-stale-feegrowthinside0lastx128feegrowthinside1lastx128)|The fee accumulator value is not synchronized with the pool's current state. | Inaccurate values of fee increases were used to calculate fees over the period of borrowing, which resulted in borrowers paying additional fees at the time of repayment. | Call collectLiquidity() to synchronize the fee accumulator.
|49|2024-02-22|[2023-12-ethereumcreditguild#h-01](https://code4rena.com/reports/2023-12-ethereumcreditguild#h-01-the-usergaugeprofitindex-is-not-set-correctly-allowing-an-attacker-to-receive-rewards-without-waiting)|The user's userGaugeProfitIndex is not properly initialized during the first call to claimGaugeRewards(). | Subsequent bias in the calculation of rewards allows the attacker to be rewarded directly. | Check if userGaugeProfitIndex is 0, and if so, set it to the current gaugeProfitIndex.
|50|2024-04-19|[2024-03-gitcoin#h-01](https://code4rena.com/reports/2024-03-gitcoin#h-01-usertotalstaked-invariant-will-be-broken-due-to-vulnerable-implementations-in-release)|userTotalStaked is not updated when releasing funds. | The actual pledge amount does not match userTotalStaked, thus miscalculating the withdrawn funds at the time of withdrawal. | Update the userTotalStaked in release().
|51|2024-04-19|[2024-01-salty#h-02](https://code4rena.com/reports/2024-01-salty#h-02-first-liquidity-provider-can-claim-all-initial-pool-rewards)|The virtualRewards is not initialized when liquidity is first provided to the protocol. | Ability to incorrectly claim all rewards in the pool due to lack of virtual reward deductions. | Call performUpkeep() before the initial distribution of the contract to achieve initialization.
|52|2024-06-24|[2024-05-bakerfi#h-04](https://code4rena.com/reports/2024-05-bakerfi#h-04-multiple-swap-lack-slippage-protection)|  The "amountOutMinimum" parameter is missing for slippage protection. | The attacker can manipulate the transaction price through a front-running attack, causing the output amount of the swap to be lower than expected. | Pass the correct amountOutMinimum value.
|53|2024-06-25|[2024-03-dittoeth#h-07](https://code4rena.com/reports/2024-03-dittoeth#h-07-valid-redemption-proposals-can-be-disputed-by-decreasing-collateral)|updatedAt is not updated when creating proposals. | The collateral ratio was calculated incorrectly and was lower than that recorded in other valid redemption proposals, thus successfully initiating an invalid dispute and obtaining penalty fees. | Update updatedAt in the decreaseCollateral() function.
|54|2024-08-06|[2024-05-olas#h-01](https://code4rena.com/reports/2024-05-olas#h-01-pointssumslope-not-updated-after-nominee-removal-and-votes-revocation)|pointsSum.slope is not updated when nominees are removed. | Errors occurred in the calculation of voting weights, affecting the accuracy of the governance mechanism. | Update pointsSum.slope in removeNominee()
|55|2024-07-19|[2024-01-curves#h-02](https://code4rena.com/reports/2024-01-curves#h-02-unrestricted-claiming-of-fees-due-to-missing-balance-updates-in-feesplitter)|Update accumulated rewards only during trades, not transfers. | The fee offset for the new account was not updated, resulting in incorrect calculation of the fees due to the account. | Call onBalanceChange() to update accumulated rewards in all balance-changing operations.
|56|2024-07-25|[2024-04-gondi#h-07](https://code4rena.com/reports/2024-04-gondi#h-07-deploywithdrawalqueue-need-to-clear-_queueaccountinglastqueueindex)|The data in _queueAccounting[lastQueueIndex] is not cleared when deploying a new withdrawal queue. | queueClaimAll() used outdated data and incorrectly allocated the total amount due. | Clear _queueAccounting[lastQueueIndex] data in deployWithdrawalQueue().
|57|2024-07-25|[2024-04-gondi#h-06](https://code4rena.com/reports/2024-04-gondi#h-06-function-settlewithbuyout-does-not-call-loanmanagerloanliquidation-during-a-buyout)|The loan pool accounting records are not updated when lenders buy out loans via the settleWithBuyout() function. | The accounting in the pool was not handled correctly, which affected the balance and profit distribution in the pool. | Call loanLiquidation() within settleWithBuyout() to ensure accounting data updates.
|58|2024-07-28|[2024-06-playfi-proleague#h-1](https://github.com/code-423n4/zenith-portfolio/tree/main/reports)|The variable limiting user purchase quantity is not updated after license purchase. | The attacker calls the claimLicensePartner() or claimLicensePublic() functions multiple times to repeatedly purchase licenses without restriction. | Accurately record each user's purchase quantity to prevent overbuying.
|59|2024-12-08|[2024-jul-gemnify-proleague#h-2](https://github.com/code-423n4/zenith-portfolio/tree/main/reports)|ps.tokenBalances[] is not updated in the safeTransfer() function. | The actual amount received returned to users when withdrawing or transferring funds is incorrect. | Call transferOut() in claimFundingFees() to update token balances during fund transfers.
|60|2024-08-06|[2024-05-olas#h-01](https://code4rena.com/reports/2024-05-olas#h-01-pointssumslope-not-updated-after-nominee-removal-and-votes-revocation)|pointsSum.slope is not updated when nominees are removed. | The slope for the removed nominees is still included in the calculation, resulting in an inaccurate calculation of the voting weight. | Update pointsSum.slope in removeNominee()
|61|2024-08-16|[2024-07-munchables#h-01](https://code4rena.com/reports/2024-07-munchables#h-01-single-plot-can-be-occupied-by-multiple-renters)| toiletState[tokenId].plotId is not updated when users transfer tokens to another plot.| Allowing multiple tenants to occupy the same plot and causing errors in reward calculations. | Update toiletState[tokenId].plotId in the transferToUnoccupiedPlot() function.
|62|2024-08-16|[2024-07-munchables#h-05](https://code4rena.com/reports/2024-07-munchables#h-05-failure-to-update-dirty-flag-in-transfertounoccupiedplot-prevents-reward-accumulation-on-valid-plot)|When the token is transferred from an invalid plot to a valid one, the user's "dirty" flag is not reinitialized. | Reward calculation was skipped by mistake. | Set the "dirty" flag when the user successfully transfers to a valid plot.
|63|2024-08-16|[2024-07-optimism#h-03](https://code4rena.com/reports/2024-07-optimism#h-03-lpp-metadata-can-be-altered-after-the-challenge-period-is-over-allowing-incorrect-states-to-be-proven)| In the initLPP function, the LPPMetadata data structure is not initialized. | Repeatedly calling the initLPP() function modifies the claimedSize and partOffset of LPP, resulting in incorrect state hashing. | Remove unnecessary storage reads in the initLPP function. Additionally, add a check in the squeezeLPP function to ensure that bytesProcessed must be equal to claimedSize.
|64|2024-09-03|[2024-07-benddao#h-03](https://code4rena.com/reports/2024-07-benddao#h-03-erc721decreaseisolatesupplyonliquidate-missing-clear-lockeraddr)|The NFT post-liquidation state is not fully reset. | The NFT cannot be unlocked successfully, which in turn affects the subsequent NFT extraction operations. | Update tokenData.lockerAddr to address(0) during liquidation.
|65|2024-09-06|[2023-11-zetachain#h-06](https://code4rena.com/reports/2023-11-zetachain#h-06-zevm-cross-chain-messages-ignore-the-user-specified-message-and-prevent-calling-the-destination-contract)| The user's message field is overwritten with an empty string. | The target contract cannot be called, which makes the cross-chain message function unable to work properly. | Modify the message field as specified by the user.
|66|2024-09-13|[2024-07-traitforge#h-04](https://code4rena.com/reports/2024-07-traitforge#h-04-number-of-entities-in-generation-can-surpass-the-10k-number)| During generation switching, the current generation's counter genMintCount is reset, failing to accurately record the true minting quantity of the previous generation when the next generation begins. | The number of new generations of entities was calculated incorrectly and allowed infinite generations of entities to be created. | Remove the operation that resets genMintCount.
|67|2024-10-18|[2024-08-superposition#h-01](https://code4rena.com/reports/2024-08-superposition#h-01-update_emergency_council_7_d_0_c_1_c_58-updates-nft-manager-instead-of-emergency-council)| The update_emergency_council_7_D_0_C_1_C_58() function fails to correctly update the target state (i.e., the emergency_council address) and instead erroneously modifies another administrative role, nft_manager. | An incorrect update to nft_manager caused emergency management to not work properly. | Update the emergency_council address.
|68|2024-10-18|[2024-08-superposition#h-02](https://code4rena.com/reports/2024-08-superposition#h-02-unrevoked-approvals-allow-nft-recovery-by-previous-owner)|The previous getApproved[_tokenId] approval status is not revoked. | Approval was not revoked after the NFT was transferred, and the previous owner transferred the NFT back to himself through repeated transactions. | Clear the approval status after transferring the NFT.
